const {
    GoogleGenerativeAI,
    HarmCategory,
    HarmBlockThreshold,
} = require("@google/generative-ai");

const apiKey = process.env.EXPO_PUBLIC_GOOGLE_GEMINI_API_KEY;
const genAI = new GoogleGenerativeAI(apiKey);

const model = genAI.getGenerativeModel({
    model: "gemini-1.5-flash",
});

const generationConfig = {
    temperature: 1,
    topP: 0.95,
    topK: 64,
    maxOutputTokens: 8192,
    responseMimeType: "application/json",
};
  
export const chatSession = model.startChat({
    generationConfig, 
    history: [
      {
        role: "user",
        parts: [
          {text: "Generate a travel plan for destination: London, UK for tarting from starting point: 71 Wols7 days and 6 nights seley St, Bexley NSW 2207, Australia on Fri Nov 15 2024 12:00:00 GMT+1100 for Family with Moderate budget.\nWe need the following details in a properly formatted nested JSON:\n1> Destination\n  * DestinationName (up to 32 characters)\n  * GeoCoordinates\n    - latitude\n    - longitude\n  * GooglePhotoRef\n  * DestinationDescriptionURL\n  * DestinationDescription (up to 256 characters)\n2> Flights (Collection of all available filghts from starting point to destination, fitting the budjet and travel dates, presented in a nested JSON format. Each flight must contain the following information)(Provide at least 4 flight options or as many possible)\n  * FlightIndex# (serially as 1, 2, 3, 4, 5...)\n  * AirlineName (up to 32 characters)\n  * GooglePhotoRef\n  * DepartureDate (DD MMM YYYY format)\n  * DepartureTime (HH:mm format)\n  * ArrivalDate (DD MMM YYYY format)\n  * ArrivalTime (HH:mm format)\n  * FlightDuration (H[h] m[m] format)\n  * OneWayTicketPriceEstimate (for one adult passenger. Numeric value only, in string format, enclosed within quotes)\n  * PriceCurrency\n  * BookingURL\n3> Hotels: (Collection of all available hotels at the destination, fitting the budjet, presented in a nested JSON format. Each hotel must contain the following information)(Provide at least 4 hotel options or as many possible)\n  * HotelIndex# (serially as 1, 2, 3, 4, 5...)\n  * HotelName (up to 32 characters)\n  * HotelAddress (up to 64 characters)\n  * HotelAddressGooglePhotoRef (google places api photo reference of the hotel's address)\n  * PricePerNight (Numeric value only, in a string format, enclosed within quotes)\n  * PriceCurrency\n  * BookingURL\n  * HotelGeoCoordinates\n  * HotelRating (Out of 5. One numeric character only, enclosed within quotes)\n  * HotelDistance (from nearest airport in Kms. Numeric value only, in string format, enclosed within quotes)\n  * HotelDescriptions (up to 256 characters)\n4> DayWiseItinerary: (Collection of itinerary for all the dates during the stay, presented in a nested JSON format)\n  * Date: (DD MMM YYYY format)\n  * PlacesToVisit: (Collection of 1 to 3 most appropriate places nearby the destination to visit during that particular date, fitting the budget and the traveller information, presented in a nested JSON format)\n    - PlaceIndex# (serially as 1, 2, 3, 4, 5...)\n    - PlaceName (up to 32 characters)\n    - PlaceGooglePhotoRef (google places api photo reference of the place)\n    - PlaceDetails (up to 256 characters)\n    - VisitStartTime (HH:mm format; MUST NOT CONFLICT with any other place to visit on that perticular day; Place MUST remain OPEN during the visit start time and duration; MUST consider adequate travel time between places to visit in a particular day)\n    - PrescribedVisitDuration (H[h] m[m] format)\n    - PlaceDescription (up to 2048 characters)\n    - GeoCoordinates\n    - EntryTicketPrice (If free or zero cost, write free; if numeric, provide only the value in a string format; if non-numeric, enclose the value within quotes)\n    - PriceCurrency (If available)\n    - TimeToTravel (H[h] m[m] format; for the first place on a particular day, provide the time to trave from the base destination; for the rest of the places provide the time to trave from the last place visited)\n    - BestTimeOfTheDayToVisit (write Morning, Afternoon, Night, Dawn, Dusk etc.)"},
        ],
      },
      {
        role: "model",
        parts: [
          {text: "```json\n{\n  \"Destination\": {\n    \"DestinationName\": \"London\",\n    \"GeoCoordinates\": {\n      \"latitude\": 51.5074,\n      \"longitude\": 0.1278\n    },\n    \"GooglePhotoRef\": \"ChIJ3S-w49x22EgR53-Z_MR6Dw\",\n    \"DestinationDescriptionURL\": \"https://en.wikipedia.org/wiki/London\",\n    \"DestinationDescription\": \"A global city with a rich history, culture, and diverse attractions.\"\n  },\n  \"Flights\": [\n    {\n      \"FlightIndex\": 1,\n      \"AirlineName\": \"Qatar Airways\",\n      \"GooglePhotoRef\": \"ChIJ_z-bX39k2EgRY8d_t37T6w\",\n      \"DepartureDate\": \"15 Nov 2024\",\n      \"DepartureTime\": \"12:00\",\n      \"ArrivalDate\": \"16 Nov 2024\",\n      \"ArrivalTime\": \"06:30\",\n      \"FlightDuration\": \"18h 30m\",\n      \"OneWayTicketPriceEstimate\": \"1200\",\n      \"PriceCurrency\": \"AUD\",\n      \"BookingURL\": \"https://www.qatarairways.com/\"\n    },\n    {\n      \"FlightIndex\": 2,\n      \"AirlineName\": \"Emirates\",\n      \"GooglePhotoRef\": \"ChIJy2Q91_9k2EgR53-Z_MR6Dw\",\n      \"DepartureDate\": \"15 Nov 2024\",\n      \"DepartureTime\": \"14:00\",\n      \"ArrivalDate\": \"16 Nov 2024\",\n      \"ArrivalTime\": \"07:45\",\n      \"FlightDuration\": \"17h 45m\",\n      \"OneWayTicketPriceEstimate\": \"1300\",\n      \"PriceCurrency\": \"AUD\",\n      \"BookingURL\": \"https://www.emirates.com/\"\n    },\n    {\n      \"FlightIndex\": 3,\n      \"AirlineName\": \"Singapore Airlines\",\n      \"GooglePhotoRef\": \"ChIJZ23dK29k2EgR53-Z_MR6Dw\",\n      \"DepartureDate\": \"15 Nov 2024\",\n      \"DepartureTime\": \"16:00\",\n      \"ArrivalDate\": \"16 Nov 2024\",\n      \"ArrivalTime\": \"08:50\",\n      \"FlightDuration\": \"16h 50m\",\n      \"OneWayTicketPriceEstimate\": \"1400\",\n      \"PriceCurrency\": \"AUD\",\n      \"BookingURL\": \"https://www.singaporeair.com/\"\n    },\n    {\n      \"FlightIndex\": 4,\n      \"AirlineName\": \"British Airways\",\n      \"GooglePhotoRef\": \"ChIJl6-Y819k2EgR53-Z_MR6Dw\",\n      \"DepartureDate\": \"15 Nov 2024\",\n      \"DepartureTime\": \"18:00\",\n      \"ArrivalDate\": \"16 Nov 2024\",\n      \"ArrivalTime\": \"10:00\",\n      \"FlightDuration\": \"16h 00m\",\n      \"OneWayTicketPriceEstimate\": \"1500\",\n      \"PriceCurrency\": \"AUD\",\n      \"BookingURL\": \"https://www.britishairways.com/\"\n    }\n  ],\n  \"Hotels\": [\n    {\n      \"HotelIndex\": 1,\n      \"HotelName\": \"The Savoy\",\n      \"HotelAddress\": \"The Strand, London WC2R 0EU\",\n      \"HotelAddressGooglePhotoRef\": \"ChIJj6R801dk2EgR53-Z_MR6Dw\",\n      \"PricePerNight\": \"300\",\n      \"PriceCurrency\": \"GBP\",\n      \"BookingURL\": \"https://www.thesavoylondon.com/\",\n      \"HotelGeoCoordinates\": {\n        \"latitude\": 51.5073,\n        \"longitude\": -0.1277\n      },\n      \"HotelRating\": \"5\",\n      \"HotelDistance\": \"15\",\n      \"HotelDescriptions\": \"A luxurious hotel with a rich history and elegant rooms.\"\n    },\n    {\n      \"HotelIndex\": 2,\n      \"HotelName\": \"The Ritz London\",\n      \"HotelAddress\": \"150 Piccadilly, London W1J 9BR\",\n      \"HotelAddressGooglePhotoRef\": \"ChIJg5lH_2dk2EgR53-Z_MR6Dw\",\n      \"PricePerNight\": \"400\",\n      \"PriceCurrency\": \"GBP\",\n      \"BookingURL\": \"https://www.theritzlondon.com/\",\n      \"HotelGeoCoordinates\": {\n        \"latitude\": 51.5075,\n        \"longitude\": -0.1419\n      },\n      \"HotelRating\": \"5\",\n      \"HotelDistance\": \"18\",\n      \"HotelDescriptions\": \"A classic hotel known for its exceptional service and grand dining.\"\n    },\n    {\n      \"HotelIndex\": 3,\n      \"HotelName\": \"The Dorchester\",\n      \"HotelAddress\": \"53 Park Ln, London W1K 1QA\",\n      \"HotelAddressGooglePhotoRef\": \"ChIJ34d6C3tk2EgR53-Z_MR6Dw\",\n      \"PricePerNight\": \"350\",\n      \"PriceCurrency\": \"GBP\",\n      \"BookingURL\": \"https://www.dorchestercollection.com/en/london/the-dorchester/\",\n      \"HotelGeoCoordinates\": {\n        \"latitude\": 51.5080,\n        \"longitude\": -0.1465\n      },\n      \"HotelRating\": \"4\",\n      \"HotelDistance\": \"16\",\n      \"HotelDescriptions\": \"A sophisticated hotel with a focus on fine dining and stylish rooms.\"\n    },\n    {\n      \"HotelIndex\": 4,\n      \"HotelName\": \"The Shard\",\n      \"HotelAddress\": \"32 London Bridge St, London SE1 9SG\",\n      \"HotelAddressGooglePhotoRef\": \"ChIJw6k6N2dk2EgR53-Z_MR6Dw\",\n      \"PricePerNight\": \"250\",\n      \"PriceCurrency\": \"GBP\",\n      \"BookingURL\": \"https://www.shangri-la.com/london/shard/\",\n      \"HotelGeoCoordinates\": {\n        \"latitude\": 51.5045,\n        \"longitude\": -0.0883\n      },\n      \"HotelRating\": \"4\",\n      \"HotelDistance\": \"10\",\n      \"HotelDescriptions\": \"A modern hotel with stunning views from its rooms and the Shardâ€™s observation deck.\"\n    }\n  ],\n  \"DayWiseItinerary\": [\n    {\n      \"Date\": \"16 Nov 2024\",\n      \"PlacesToVisit\": [\n        {\n          \"PlaceIndex\": 1,\n          \"PlaceName\": \"Buckingham Palace\",\n          \"PlaceGooglePhotoRef\": \"ChIJN71783dk2EgR53-Z_MR6Dw\",\n          \"PlaceDetails\": \"The official residence of the British monarch.\",\n          \"VisitStartTime\": \"10:00\",\n          \"PrescribedVisitDuration\": \"2h 00m\",\n          \"PlaceDescription\": \"Witness the Changing of the Guard ceremony (11:00 am) or explore the State Rooms during the summer months (July-August).\",\n          \"GeoCoordinates\": {\n            \"latitude\": 51.5014,\n            \"longitude\": -0.1419\n          },\n          \"EntryTicketPrice\": \"free\",\n          \"PriceCurrency\": \"GBP\",\n          \"TimeToTravel\": \"1h 00m\",\n          \"BestTimeOfTheDayToVisit\": \"Morning\"\n        },\n        {\n          \"PlaceIndex\": 2,\n          \"PlaceName\": \"Tower Bridge\",\n          \"PlaceGooglePhotoRef\": \"ChIJh70P1Wdk2EgR53-Z_MR6Dw\",\n          \"PlaceDetails\": \"A Victorian bridge that spans the River Thames.\",\n          \"VisitStartTime\": \"13:00\",\n          \"PrescribedVisitDuration\": \"1h 30m\",\n          \"PlaceDescription\": \"Walk across the bridge and enjoy the views of the city, or take a guided tour to learn about its history and engineering marvels.\",\n          \"GeoCoordinates\": {\n            \"latitude\": 51.5044,\n            \"longitude\": -0.0859\n          },\n          \"EntryTicketPrice\": \"free\",\n          \"PriceCurrency\": \"GBP\",\n          \"TimeToTravel\": \"40m\",\n          \"BestTimeOfTheDayToVisit\": \"Afternoon\"\n        }\n      ]\n    },\n    {\n      \"Date\": \"17 Nov 2024\",\n      \"PlacesToVisit\": [\n        {\n          \"PlaceIndex\": 1,\n          \"PlaceName\": \"The British Museum\",\n          \"PlaceGooglePhotoRef\": \"ChIJ18Zv23dk2EgR53-Z_MR6Dw\",\n          \"PlaceDetails\": \"A world-renowned museum with a vast collection of artifacts.\",\n          \"VisitStartTime\": \"10:00\",\n          \"PrescribedVisitDuration\": \"3h 00m\",\n          \"PlaceDescription\": \"Explore ancient civilizations, from the Rosetta Stone to the Elgin Marbles. Admission is free.\",\n          \"GeoCoordinates\": {\n            \"latitude\": 51.5192,\n            \"longitude\": -0.1276\n          },\n          \"EntryTicketPrice\": \"free\",\n          \"PriceCurrency\": \"GBP\",\n          \"TimeToTravel\": \"50m\",\n          \"BestTimeOfTheDayToVisit\": \"Morning\"\n        }\n      ]\n    },\n    {\n      \"Date\": \"18 Nov 2024\",\n      \"PlacesToVisit\": [\n        {\n          \"PlaceIndex\": 1,\n          \"PlaceName\": \"London Eye\",\n          \"PlaceGooglePhotoRef\": \"ChIJcW0N1Wdk2EgR53-Z_MR6Dw\",\n          \"PlaceDetails\": \"A giant Ferris wheel offering panoramic views of London.\",\n          \"VisitStartTime\": \"11:00\",\n          \"PrescribedVisitDuration\": \"1h 30m\",\n          \"PlaceDescription\": \"Book tickets online to skip the line. Enjoy breathtaking views of iconic landmarks.\",\n          \"GeoCoordinates\": {\n            \"latitude\": 51.5033,\n            \"longitude\": -0.1195\n          },\n          \"EntryTicketPrice\": \"30\",\n          \"PriceCurrency\": \"GBP\",\n          \"TimeToTravel\": \"1h 00m\",\n          \"BestTimeOfTheDayToVisit\": \"Afternoon\"\n        }\n      ]\n    },\n    {\n      \"Date\": \"19 Nov 2024\",\n      \"PlacesToVisit\": [\n        {\n          \"PlaceIndex\": 1,\n          \"PlaceName\": \"National Gallery\",\n          \"PlaceGooglePhotoRef\": \"ChIJtR0O-2tk2EgR53-Z_MR6Dw\",\n          \"PlaceDetails\": \"An art museum with a collection of paintings from the Middle Ages to the 19th century.\",\n          \"VisitStartTime\": \"10:00\",\n          \"PrescribedVisitDuration\": \"2h 00m\",\n          \"PlaceDescription\": \"Admire works by renowned artists such as Leonardo da Vinci, Michelangelo, and Van Gogh.\",\n          \"GeoCoordinates\": {\n            \"latitude\": 51.5072,\n            \"longitude\": -0.1277\n          },\n          \"EntryTicketPrice\": \"free\",\n          \"PriceCurrency\": \"GBP\",\n          \"TimeToTravel\": \"10m\",\n          \"BestTimeOfTheDayToVisit\": \"Morning\"\n        }\n      ]\n    },\n    {\n      \"Date\": \"20 Nov 2024\",\n      \"PlacesToVisit\": [\n        {\n          \"PlaceIndex\": 1,\n          \"PlaceName\": \"Hyde Park\",\n          \"PlaceGooglePhotoRef\": \"ChIJvS4W-2tk2EgR53-Z_MR6Dw\",\n          \"PlaceDetails\": \"A large park in central London with green spaces, lakes, and gardens.\",\n          \"VisitStartTime\": \"11:00\",\n          \"PrescribedVisitDuration\": \"3h 00m\",\n          \"PlaceDescription\": \"Enjoy a leisurely walk, picnic, or boat ride on the Serpentine Lake. Visit Kensington Palace (home to the Duke and Duchess of Cambridge) nearby.\",\n          \"GeoCoordinates\": {\n            \"latitude\": 51.5074,\n            \"longitude\": -0.1653\n          },\n          \"EntryTicketPrice\": \"free\",\n          \"PriceCurrency\": \"GBP\",\n          \"TimeToTravel\": \"30m\",\n          \"BestTimeOfTheDayToVisit\": \"Afternoon\"\n        }\n      ]\n    },\n    {\n      \"Date\": \"21 Nov 2024\",\n      \"PlacesToVisit\": [\n        {\n          \"PlaceIndex\": 1,\n          \"PlaceName\": \"St. Paul's Cathedral\",\n          \"PlaceGooglePhotoRef\": \"ChIJ-T2tM2tk2EgR53-Z_MR6Dw\",\n          \"PlaceDetails\": \"A historic cathedral with a magnificent dome and stunning interior.\",\n          \"VisitStartTime\": \"10:00\",\n          \"PrescribedVisitDuration\": \"1h 30m\",\n          \"PlaceDescription\": \"Climb the dome for panoramic views of the city. Attend a service or simply admire the architecture.\",\n          \"GeoCoordinates\": {\n            \"latitude\": 51.5130,\n            \"longitude\": -0.0980\n          },\n          \"EntryTicketPrice\": \"20\",\n          \"PriceCurrency\": \"GBP\",\n          \"TimeToTravel\": \"40m\",\n          \"BestTimeOfTheDayToVisit\": \"Morning\"\n        }\n      ]\n    }\n  ]\n}\n```"},
        ],
      },
    ],
});